var b=Object.defineProperty;var y=(s,e,t)=>e in s?b(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var c=(s,e,t)=>y(s,typeof e!="symbol"?e+"":e,t);import{i as h,r as v,u as k,a as T,d as m,o as P,b as w,c as d,F as _,e as B,f as a,g as i,h as D,t as p,j as l,k as g,l as F,m as x,p as C,n as $,q as N}from"./index-BznTXl3y.js";const V="fileTree",E=()=>h(V);class L{constructor(e){c(this,"rootFolder",v());c(this,"selectedFile",v());c(this,"fileProvider",k());c(this,"bookProvider",T());this.driveProvider=e}async loadRoot(){this.rootFolder.value=await this.driveProvider.listByFolder("1zZJkLqk_eDk0UNfofXaJ4aDBSIHhnWbk")}async onSelectedFile(e){if(!e.isFolder){this.selectedFile.value=e;return}if(e.folderData){e.folderData=void 0;return}e.folderData=await this.driveProvider.listByFolder(e.data.id)}getFilteTreeFiles(e){return e.files.map(t=>({data:t,isFolder:t.mimeType.includes("folder")})).sort((t,o)=>t.isFolder&&!o.isFolder?-1:!t.isFolder&&o.isFolder?1:0)}closeFile(){this.selectedFile.value=void 0}}const S={class:"file-tree"},R=["onClick"],j={key:0},q={key:1},I={key:0,class:"ml-4"},J=m({__name:"FileTree",props:{data:{}},setup(s){const e=E(),t=s,o=v(e.getFilteTreeFiles(t.data));return P(()=>{}),(f,r)=>{const u=w("FileTree",!0);return a(),d("ul",S,[(a(!0),d(_,null,B(o.value,(n,X)=>(a(),d(_,null,[i("li",{class:"file-tree__item cursor-pointer font-semibold",onClick:Z=>l(e).onSelectedFile(n)},[n.isFolder?(a(),d("span",j,"📁 ")):(a(),d("span",q,"📄 ")),D(" "+p(n.data.name),1)],8,R),n.folderData?(a(),d("li",I,[g(u,{data:n.folderData},null,8,["data"])])):F("",!0)],64))),256))])}}}),M={class:"mt-4 relative"},z={class:"library shadow-md"},A={class:"library__container"},H={key:0,class:"file-preview"},U={class:"file-preview__container gap-2"},W={class:"font-semibold text-lg"},O=m({__name:"LibraryView",setup(s){const e=x(),t=k(),o=new L(e);return C("fileTree",o),$(async()=>{await o.loadRoot()}),(f,r)=>(a(),d("div",M,[i("div",z,[i("div",A,[l(o).rootFolder.value?(a(),N(J,{key:0,data:l(o).rootFolder.value},null,8,["data"])):F("",!0)]),l(o).selectedFile.value?(a(),d("div",H,[i("div",U,[i("h3",W,p(l(o).selectedFile.value.data.name),1),r[3]||(r[3]=i("div",{class:"grow"},null,-1)),i("button",{type:"button",class:"k-button k-button-md k-rounded-md k-button-link with-underline",onClick:r[0]||(r[0]=(...u)=>l(o).closeFile&&l(o).closeFile(...u))},r[2]||(r[2]=[i("span",{class:"k-button-text"},"Close",-1)])),i("button",{type:"button",class:"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary px-6",onClick:r[1]||(r[1]=u=>l(t).addFile(l(o).selectedFile.value.data))}," Add file ")])])):F("",!0)])]))}});export{O as default};
