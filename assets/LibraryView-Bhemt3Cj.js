var b=Object.defineProperty;var y=(s,e,t)=>e in s?b(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var c=(s,e,t)=>y(s,typeof e!="symbol"?e+"":e,t);import{i as h,r as v,u as p,a as T,d as m,o as P,b as w,c as d,F as _,e as x,f as a,g as i,h as C,t as k,j as l,k as g,l as F,m as B,p as $,n as D,q as V}from"./index-D7IcR962.js";const E="fileTree",L=()=>h(E);class N{constructor(e){c(this,"rootFolder",v());c(this,"selectedFile",v());c(this,"fileProvider",p());c(this,"bookProvider",T());this.driveProvider=e}async loadRoot(){this.rootFolder.value=await this.driveProvider.listByFolder("1bz6kCepA_J4r5wVlHZYcs-LVExQMHFsa")}async onSelectedFile(e){if(!e.isFolder){this.selectedFile.value=e;return}if(e.folderData){e.folderData=void 0;return}e.folderData=await this.driveProvider.listByFolder(e.data.id)}getFilteTreeFiles(e){return e.files.map(t=>({data:t,isFolder:t.mimeType.includes("folder")})).sort((t,o)=>t.isFolder&&!o.isFolder?-1:!t.isFolder&&o.isFolder?1:0)}closeFile(){this.selectedFile.value=void 0}}const M={class:"file-tree"},R=["onClick"],S={key:0},j={key:1},A={key:0,class:"ml-4"},H=m({__name:"FileTree",props:{data:{}},setup(s){const e=L(),t=s,o=v(e.getFilteTreeFiles(t.data));return P(()=>{}),(f,r)=>{const u=w("FileTree",!0);return a(),d("ul",M,[(a(!0),d(_,null,x(o.value,(n,Z)=>(a(),d(_,null,[i("li",{class:"file-tree__item cursor-pointer font-semibold",onClick:G=>l(e).onSelectedFile(n)},[n.isFolder?(a(),d("span",S,"📁 ")):(a(),d("span",j,"📄 ")),C(" "+k(n.data.name),1)],8,R),n.folderData?(a(),d("li",A,[g(u,{data:n.folderData},null,8,["data"])])):F("",!0)],64))),256))])}}}),q={class:"mt-4 relative"},z={class:"library shadow-md"},I={class:"library__container"},J={key:0,class:"file-preview"},Q={class:"file-preview__container gap-2"},Y={class:"font-semibold text-lg"},U=m({__name:"LibraryView",setup(s){const e=B(),t=p(),o=new N(e);return $("fileTree",o),D(async()=>{await o.loadRoot()}),(f,r)=>(a(),d("div",q,[i("div",z,[i("div",I,[l(o).rootFolder.value?(a(),V(H,{key:0,data:l(o).rootFolder.value},null,8,["data"])):F("",!0)]),l(o).selectedFile.value?(a(),d("div",J,[i("div",Q,[i("h3",Y,k(l(o).selectedFile.value.data.name),1),r[3]||(r[3]=i("div",{class:"grow"},null,-1)),i("button",{type:"button",class:"k-button k-button-md k-rounded-md k-button-link with-underline",onClick:r[0]||(r[0]=(...u)=>l(o).closeFile&&l(o).closeFile(...u))},r[2]||(r[2]=[i("span",{class:"k-button-text"},"Close",-1)])),i("button",{type:"button",class:"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary px-6",onClick:r[1]||(r[1]=u=>l(t).addFile(l(o).selectedFile.value.data))}," Add file ")])])):F("",!0)])]))}});export{U as default};
